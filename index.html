<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExtraTvLive</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" xintegrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2k5u16r+P0hN45d5aT5S4yL2z8j5XkY5rQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            position: relative;
        }

        #video-container {
            position: relative;
            width: 100%;
            height: 100%;
        }

        #video-player {
            width: 100%;
            height: 100%;
            background-color: #000;
        }

        #main-button {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #f2f2f2;
            color: #171717;
            border: none;
            border-radius: 9999px;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            transition: all 0.2s ease-in-out;
        }

        #main-button:hover {
            background-color: #e5e5e5;
            transform: translateX(-50%) scale(1.05);
        }

        .icon {
            font-size: 2.5rem;
        }

        .player-controls {
            position: absolute;
            bottom: 0;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: opacity 0.3s ease;
        }

        .volume-container {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .volume-range {
            width: 80px;
        }

        /* Fullscreen styles */
        .full-screen-container {
            width: 100vw;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 9999;
        }
    </style>
</head>

<body>
    <div id="video-container">
        <video id="video-player" playsinline></video>
        <button id="main-button">
            <i id="main-icon" class="fa-solid"></i>
        </button>
    </div>

    <div id="install-popup" class="fixed inset-x-4 bottom-8 flex flex-col items-center justify-center p-4 bg-white shadow-xl rounded-lg border border-gray-200 z-50 transform scale-100 opacity-100 transition-transform duration-300">
        <div class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 cursor-pointer text-2xl" onclick="hideInstallPopup()">
            <i class="fa-solid fa-xmark"></i>
        </div>
        <div class="text-center">
            <div class="mb-4">
                <h3 class="text-xl font-bold text-gray-900">Installa sul tuo iPhone</h3>
                <p class="text-gray-600 mt-2">
                    Per installare l'app, tocca il pulsante
                    <span class="inline-flex items-center justify-center w-8 h-8 mx-1">
                        <svg fill="currentColor" class="w-6 h-6" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M19 21H5a2 2 0 01-2-2V9a2 2 0 012-2h3V5a2 2 0 012-2h4a2 2 0 012 2v2h3a2 2 0 012 2v10a2 2 0 01-2 2zM5 9v10h14V9h-3V7a2 2 0 01-2-2H10a2 2 0 01-2 2v2H5zM12 11a1 1 0 00-1 1v4a1 1 0 002 0v-4a1 1 0 00-1-1zm0 2a1 1 0 01-1 1v1a1 1 0 012 0v-1a1 1 0 01-1-1z" clip-rule="evenodd" fill-rule="evenodd"/>
                        </svg>
                    </span>
                    e seleziona "Aggiungi a schermata Home".
                </p>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const video = document.getElementById('video-player');
            const mainButton = document.getElementById('main-button');
            const mainIcon = document.getElementById('main-icon');
            const installPopup = document.getElementById('install-popup');
            let isPaused = true;

            function updateMainButton() {
                if (video.paused) {
                    mainIcon.classList.remove('fa-pause');
                    mainIcon.classList.add('fa-play');
                } else {
                    mainIcon.classList.remove('fa-play');
                    mainIcon.classList.add('fa-pause');
                }
            }

            mainButton.addEventListener('click', function() {
                if (video.paused) {
                    video.play();
                } else {
                    video.pause();
                }
            });

            // Mostra il popup di installazione solo su iOS Safari
            function showInstallPopup() {
                const isIos = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
                const isSafari = navigator.userAgent.includes('Safari') && !navigator.userAgent.includes('Chrome');
                const isStandalone = (window.matchMedia('(display-mode: standalone)').matches);
                if (isIos && isSafari && !isStandalone) {
                    installPopup.classList.remove('opacity-0', 'scale-0');
                    installPopup.classList.add('opacity-100', 'scale-100');
                }
            }

            function hideInstallPopup() {
                installPopup.classList.remove('opacity-100', 'scale-100');
                installPopup.classList.add('opacity-0', 'scale-0');
            }

            // Mostra il popup dopo 3 secondi per dare tempo alla pagina di caricarsi
            setTimeout(showInstallPopup, 3000);

            // Aggiungi un event listener per il doppio tocco
            let lastClickTime = 0;
            video.addEventListener('click', (e) => {
                const clickTime = new Date().getTime();
                if (clickTime - lastClickTime < 300) {
                    // Ãˆ un doppio tocco
                    if (document.fullscreenElement) {
                        document.exitFullscreen();
                    } else if (video.webkitEnterFullscreen) { // Fallback for iOS Safari
                         // If the video is already in fullscreen on iOS, exit it
                         if (document.webkitFullscreenElement) {
                            document.webkitExitFullscreen();
                        } else {
                            video.webkitEnterFullscreen();
                        }
                    } else if (video.requestFullscreen) {
                        video.requestFullscreen();
                    }
                }
                lastClickTime = clickTime;
            });

            // Sincronizza lo stato del pulsante se l'utente usa i controlli nativi del player
            video.addEventListener('volumechange', updateMainButton);
            video.addEventListener('play', updateMainButton);
            video.addEventListener('pause', updateMainButton);

            // Stato iniziale
            updateMainButton();
        });
    </script>
</body>

</html>
